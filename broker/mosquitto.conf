# Mosquitto MQTT Broker Configuration
# For UxPlay Fleet Management System

# =============================================================================
# Listeners
# =============================================================================

# Standard MQTT listener for devices
listener 1883 0.0.0.0

# WebSocket listener for admin console
listener 9001 0.0.0.0
protocol websockets

# =============================================================================
# Security (Development - Open Access)
# =============================================================================
# WARNING: For production, enable authentication!

allow_anonymous true

# =============================================================================
# Security (Production - With Authentication)
# =============================================================================
# Uncomment these lines and comment out allow_anonymous for production:

# allow_anonymous false
# password_file /etc/mosquitto/passwd

# Create password file with:
#   sudo mosquitto_passwd -c /etc/mosquitto/passwd uxplay-admin
#   sudo mosquitto_passwd /etc/mosquitto/passwd uxplay-device

# =============================================================================
# Persistence
# =============================================================================

persistence true
persistence_location /var/lib/mosquitto/

# Retain messages for device configs and status
# Messages are stored and re-delivered to new subscribers

# =============================================================================
# Logging
# =============================================================================

log_dest file /var/log/mosquitto/mosquitto.log
log_type error
log_type warning
log_type notice
log_type information

# For debugging, uncomment:
# log_type debug
# log_type subscribe
# log_type unsubscribe

# =============================================================================
# Connection Settings
# =============================================================================

# Maximum QoS level supported
max_qos 2

# Keepalive interval (seconds)
# Devices send heartbeat; set slightly higher than client keepalive
max_keepalive 120

# Maximum packet size (bytes)
max_packet_size 1048576

# =============================================================================
# TLS/SSL (Production - Encrypted Connections)
# =============================================================================
# For production, enable TLS:

# listener 8883 0.0.0.0
# cafile /etc/mosquitto/certs/ca.crt
# certfile /etc/mosquitto/certs/server.crt
# keyfile /etc/mosquitto/certs/server.key
# require_certificate false

# listener 9443 0.0.0.0
# protocol websockets
# cafile /etc/mosquitto/certs/ca.crt
# certfile /etc/mosquitto/certs/server.crt
# keyfile /etc/mosquitto/certs/server.key
